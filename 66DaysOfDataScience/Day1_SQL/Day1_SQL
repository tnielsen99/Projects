import os
import sqlite3

DEFAULT_PATH = os.path.join(os.getcwd(),'jobs.db')

def db_connect(db_path=DEFAULT_PATH):
    connection = sqlite3.connect(db_path)
    cursor = connection.cursor()
    return cursor

# Some other example server values are
# server = 'localhost\sqlexpress' # for a named instance
# server = 'myserver,port' # to specify an alternate port
server = '*****' 
database = '*****' 
username = '*****' 
password = '****' 
params = urllib.parse.quote_plus("Driver={ODBC Driver 17 for SQL Server};Server=mal-tazlsql01.database.windows.net;DATABASE=powertrain;UID=timo.nielsen@mclaren.com;PWD=Mclaren07;Authentication=ActiveDirectoryInteractive")
engine = sqlalchemy.create_engine("mssql+pyodbc:///?odbc_connect=%s" % params)

@event.listens_for(engine, 'before_cursor_execute')
def receive_before_cursor_execute(conn, cursor, statement, params, context, executemany):
       if executemany:
            cursor.fast_executemany = True
            cursor.commit()

conn=engine.connect()
print(conn)

cur = db_connect(DEFAULT_PATH)